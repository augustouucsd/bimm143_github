---
title: "lab 5: data viz with ggplot"
author: "Minzhou Ou(PID: A17293812)"
format: pdf
toc: true
---

## Background
There are lot's of ways to make plots in R. THese include so-called "base R" ( like the `plot()`) and add on packages like **ggplot2**.

Let's make the same plot with these two graphics system. We can use the inbuilt `cars` dataset:


```{r}
head(cars)
```
With "base R" we can simply:

```{r}
plot(cars)
```


We need to innstall the package using `install.packages("ggplot2")`.

> **N.B.** We never run an `install.packages()` in a code chunk otherwise we will re-install needlesely every timme we render our document.

Every time we want to use an add-on package we need to load it up with a call to `library()`

```{r}
library(ggplot2)
```

Every ggplot needs at least 3 thinngs:

1. The **data** i.e. stuff to plot as a data.frame
2. The **aes** or aesthetics taht map the data to the plot

```{r}
library(ggplot2)
ggplot(cars) + 
  aes(x=speed, y=dist) + 
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x="Speed (MPH)",
       y="Distance (ft)",
       title="Stopping Distannce of old cars")
```
## Genne Expression PLot

Read some data on the effects of GLP-1 inhibitor (drug_ on gene expression values:)
```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

Version 1 plot - start simple by getting some ink on the page.

```{r}
ggplot(genes) +
  aes(Condition1, Condition2) +
  geom_point(col="blue", alpha=0.2)
```

Let's color by `State` up, down or no change.

```{r}
table(genes$State)
```

```{r}
ggplot(genes) +
  aes(Condition1, Condition2, col=State) +
  geom_point() +
  scale_color_manual(values = c("brown", "grey", "pink")) +
  labs(x="Control (no drug)",
       y="Drug",
       title="Expression changes upon GLP-1 inhibition") +
  theme_minimal()
```

## GOing further with gapmider

Here we explore the famous `gapmider` dataset with some custom plots.

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
head(gapminder)
```
> Q. How many rows does this dataset have?

```{r}
nrow(gapminder)
```
> Q. How many different continents are in this dataset?

```{r}
table(gapminder$continent)
```

Version 1 plot gdpPercap vs lifeExp for all rows

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent) +
  geom_point(alpha=0.5) +
  scale_color_manual(values = c("brown", "green", "yellow", "grey", "blue"))
```

I want to see a plot for each continent - in ggplot lingo this is called "faceting"

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent) +
  geom_point(alpha=0.5) +
  facet_wrap(~continent)
```

## First look at the dplyr package

Another add-on package with a function called `filter()` that we want to use.

For the years above 2000
```{r}
library(dplyr)
gap_2000 <- gapminder %>% 
  filter(year >= 2000)
ggplot(gap_2000) +
  aes(gdpPercap, lifeExp, col=continent) +
  geom_point(alpha=0.5) +
  scale_color_manual(values = c("brown", "green", "yellow", "grey", "blue"))
```
```{r}
filter(gapminder, year==2007, country=="Ireland")
```

```{r}
input <- filter(gapminder, year==2007 | year==1977)
ggplot(input) +
  aes(gdpPercap, lifeExp, col=continent) +
  geom_point(alpha=0.5) +
  facet_wrap(~year)
```

